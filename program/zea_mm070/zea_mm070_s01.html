<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZEA_MM070_S01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZEA_MM070_S01</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Include YXXX0040_S01</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Include          ZEA_MM070_S01</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0100 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE STATUS_0100 OUTPUT.

  SET PF-STATUS 'S0100'.
  SET TITLEBAR  'T0100'.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Module  USER_COMMAND_0100  INPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*       text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
MODULE USER_COMMAND_0100 INPUT.

  CASE OK_CODE.
<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'CHANGE'.
      PERFORM CHANGE_RTN.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'DISPLAY'.
      PERFORM DISPLAY_RTN.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'REFRESH'.
      PERFORM REFRESH_RTN.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'GOIV'.
      CALL TRANSACTION 'ZEA_MM080'.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN OTHERS.
  ENDCASE.
  CLEAR: OK_CODE.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Module  EXIT_0100  INPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*       text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
MODULE EXIT_0100 INPUT.

  CASE OK_CODE.
<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'EXIT'.
      LEAVE TO SCREEN 0.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN 'CANC'.
      LEAVE TO SCREEN 0.

<font color ="#0000FF">*   -------------------------------------------------------------------</font>
    WHEN OTHERS.
  ENDCASE.
  CLEAR: OK_CODE.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module INIT_0100 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE INIT_0100 OUTPUT.

  IF GO_CONTAINER1 IS INITIAL.

    PERFORM CREATE_OBJECT1.
    PERFORM CREATE_ALV_OBJ1.

  ELSE.

    PERFORM REFRESH_TABLE_DISPLAY.

  ENDIF.

  IF GO_CONTAINER IS INITIAL.

    PERFORM CREATE_OBJECT2.
    PERFORM CREATE_ALV_OBJ2.

    PERFORM CREATE_OBJECT3.
    PERFORM CREATE_ALV_OBJ3.

  ELSE.

    PERFORM REFRESH_TABLE_DISPLAY.

  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT1 .

  CREATE OBJECT GO_CONTAINER1
  EXPORTING CONTAINER_NAME = 'CON1'.

  CREATE OBJECT GO_GRID1
  EXPORTING I_PARENT = GO_CONTAINER1.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_ALV_OBJ1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_ALV_OBJ1 .

<font color ="#0000FF">*-----------------------------------------------*</font>
  PERFORM SET_FIELDCAT CHANGING GT_FCAT1.
  PERFORM SET_LAYOUT   CHANGING GS_LAYO1.
  PERFORM SET_SORT     CHANGING GT_SORT1.
  PERFORM SET_GRID_EVENT_RECEIVER1.
  PERFORM SET_GRID_FIRST_DISPLAY1.
<font color ="#0000FF">*-----------------------------------------------*</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FIELDCAT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_FCAT1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FIELDCAT  CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA : LT_SLIS_FCAT  TYPE  SLIS_T_FIELDCAT_ALV.

  DATA : LV_PROG_NAME  LIKE SY-REPID.
  DATA : LV_INCLNAME   LIKE SY-REPID.

  DATA : LT_FCAT       TYPE  LVC_T_FCAT.

  CLEAR: LV_PROG_NAME, LV_INCLNAME.
  LV_PROG_NAME = SY-REPID.
  LV_INCLNAME  = SY-REPID.

  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'
    EXPORTING
      I_PROGRAM_NAME         = LV_PROG_NAME
      I_INCLNAME             = LV_INCLNAME
      I_CLIENT_NEVER_DISPLAY = 'X'
      I_INTERNAL_TABNAME     = 'GT_DISP1'
    CHANGING
      CT_FIELDCAT            = LT_SLIS_FCAT
   EXCEPTIONS
     INCONSISTENT_INTERFACE  = 1
     PROGRAM_ERROR           = 2
     OTHERS                  = 3.

  CALL FUNCTION 'LVC_TRANSFER_FROM_SLIS'
    EXPORTING
      IT_FIELDCAT_ALV = LT_SLIS_FCAT
    IMPORTING
      ET_FIELDCAT_LVC = LT_FCAT
    TABLES
      IT_DATA         = GT_DISP1
    EXCEPTIONS
      IT_DATA_MISSING = 1
      OTHERS          = 2.

  CALL FUNCTION 'LVC_FIELDCAT_COMPLETE'
    CHANGING
      CT_FIELDCAT = LT_FCAT.

  CLEAR: PT_FCAT[].
  PT_FCAT[] = LT_FCAT[].

  LOOP AT PT_FCAT ASSIGNING FIELD-SYMBOL(&lt;LFS_FCAT&gt;).
<font color ="#0000FF">*    &lt;LFS_FCAT&gt;-OUTPUTLEN = 12.</font>
    &lt;LFS_FCAT&gt;-KEY       = SPACE.
    CASE &lt;LFS_FCAT&gt;-FIELDNAME.
      WHEN 'ICON'.
        &lt;LFS_FCAT&gt;-COL_POS   = 1.
        &lt;LFS_FCAT&gt;-COLTEXT   = '상태'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 3.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'PONUM'.
        &lt;LFS_FCAT&gt;-COL_POS   = 2.
        &lt;LFS_FCAT&gt;-COLTEXT = '구매오더번호'.
        &lt;LFS_FCAT&gt;-KEY     = 'X'.
        &lt;LFS_FCAT&gt;-HOTSPOT = 'X'.
       &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'EBELP'.
        &lt;LFS_FCAT&gt;-COL_POS   = 3.
        &lt;LFS_FCAT&gt;-COLTEXT = '품목번호'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-KEY     = 'X'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'BANFN'.
        &lt;LFS_FCAT&gt;-COL_POS   = 4.
        &lt;LFS_FCAT&gt;-COLTEXT = '구매요청'.
        &lt;LFS_FCAT&gt;-EMPHASIZE = 'C310'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
      WHEN 'MATNR'.
        &lt;LFS_FCAT&gt;-COLTEXT = '자재코드'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
      WHEN 'VENCODE'.
        &lt;LFS_FCAT&gt;-COLTEXT = '공급업체'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
      WHEN 'INFO_NO'.
        &lt;LFS_FCAT&gt;-COLTEXT = '정보레코드'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
      WHEN 'WERKS'.
        &lt;LFS_FCAT&gt;-COLTEXT = '플랜트'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
      WHEN 'LGORT'.
        &lt;LFS_FCAT&gt;-COLTEXT = '저장위치'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
      WHEN 'CALQTY'.
        &lt;LFS_FCAT&gt;-COLTEXT = '오더 수량'.
        &lt;LFS_FCAT&gt;-DO_SUM  = 'X'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
      WHEN 'MEINS'.
        &lt;LFS_FCAT&gt;-COLTEXT = '오더 단위'.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.

      WHEN 'DMBTR'.
        &lt;LFS_FCAT&gt;-COLTEXT = '금액'.
        &lt;LFS_FCAT&gt;-DO_SUM  = 'X'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 13.
      WHEN 'WAERS'.
        &lt;LFS_FCAT&gt;-COLTEXT = '통화'.
        &lt;LFS_FCAT&gt;-JUST = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
      WHEN OTHERS.
        &lt;LFS_FCAT&gt;-TECH = 'X'.


    ENDCASE.
  ENDLOOP.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GS_LAYO1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT  CHANGING PS_LAYO TYPE LVC_S_LAYO.

  CLEAR: PS_LAYO.
  PS_LAYO-NO_ROWINS  = 'X'.
  PS_LAYO-NO_ROWMOVE = 'X'.
  PS_LAYO-SEL_MODE   = 'D'.
  PS_LAYO-STYLEFNAME = 'CELL_STYLE'.
<font color ="#0000FF">*  PS_LAYO-CWIDTH_OPT = 'A'.</font>

  DATA : LV_TITLE TYPE LVC_TITLE.
  DATA(LV_CNT) = LINES( GT_DISP1 ).
  LV_TITLE = '구매오더: ' && LV_CNT && '건'.
  PS_LAYO-GRID_TITLE = LV_TITLE.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_FIRST_DISPLAY1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_FIRST_DISPLAY1 .

  CALL METHOD GO_GRID1-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT                     = GS_LAYO1
    CHANGING
      IT_OUTTAB                     = GT_DISP1[]
      IT_FIELDCATALOG               = GT_FCAT1[]
      IT_SORT                       = GT_SORT1[]
    EXCEPTIONS
      INVALID_PARAMETER_COMBINATION = 1
      PROGRAM_ERROR                 = 2
      TOO_MANY_LINES                = 3
      OTHERS                        = 4.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form REFRESH_TABLE_DISPLAY</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM REFRESH_TABLE_DISPLAY .

  DATA : LS_STBL TYPE LVC_S_STBL.

  CLEAR: LS_STBL.
  LS_STBL-ROW = 'X'.
  LS_STBL-COL = 'X'.

  IF GO_GRID1 IS NOT INITIAL.
    CLEAR: GT_FCAT1[].
    PERFORM SET_FIELDCAT CHANGING GT_FCAT1.
    CALL METHOD GO_GRID1-&gt;SET_FRONTEND_FIELDCATALOG
    EXPORTING IT_FIELDCATALOG = GT_FCAT1.

    CLEAR: GS_LAYO1.
    PERFORM SET_LAYOUT   CHANGING GS_LAYO1.
    CALL METHOD GO_GRID1-&gt;SET_FRONTEND_LAYOUT
    EXPORTING IS_LAYOUT = GS_LAYO1.

    CALL METHOD GO_GRID1-&gt;REFRESH_TABLE_DISPLAY
    EXPORTING IS_STABLE = LS_STBL.
  ENDIF.

  IF GO_GRID2 IS NOT INITIAL.
    CLEAR: GT_FCAT2[].
    PERFORM SET_FIELDCAT2 CHANGING GT_FCAT2.
    CALL METHOD GO_GRID1-&gt;SET_FRONTEND_FIELDCATALOG
    EXPORTING IT_FIELDCATALOG = GT_FCAT2.

    CLEAR: GS_LAYO2.
    PERFORM SET_LAYOUT2   CHANGING GS_LAYO2.
    CALL METHOD GO_GRID2-&gt;SET_FRONTEND_LAYOUT
    EXPORTING IS_LAYOUT = GS_LAYO2.

    CALL METHOD GO_GRID2-&gt;REFRESH_TABLE_DISPLAY
    EXPORTING IS_STABLE = LS_STBL.
  ENDIF.

  IF GO_GRID3 IS NOT INITIAL.
    CLEAR: GT_FCAT3[].
    PERFORM SET_FIELDCAT3 CHANGING GT_FCAT3.
    CALL METHOD GO_GRID3-&gt;SET_FRONTEND_FIELDCATALOG
    EXPORTING IT_FIELDCATALOG = GT_FCAT3.

    CLEAR: GS_LAYO3.
    PERFORM SET_LAYOUT3   CHANGING GS_LAYO3.
    CALL METHOD GO_GRID3-&gt;SET_FRONTEND_LAYOUT
    EXPORTING IS_LAYOUT = GS_LAYO3.

    CALL METHOD GO_GRID3-&gt;REFRESH_TABLE_DISPLAY
    EXPORTING IS_STABLE = LS_STBL.
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT2 .

  CREATE OBJECT GO_CONTAINER
  EXPORTING CONTAINER_NAME  = 'CON2'.

  CREATE OBJECT GO_SPLITTER
  EXPORTING PARENT  = GO_CONTAINER
            ROWS    = 2
            COLUMNS = 1.

  CALL METHOD GO_SPLITTER-&gt;SET_ROW_HEIGHT
  EXPORTING ID    = 1
            HEIGHT = 47.

  CALL METHOD GO_SPLITTER-&gt;GET_CONTAINER
  EXPORTING ROW    = 1
            COLUMN = 1
  RECEIVING CONTAINER = GO_ALV_CON2.

  CREATE OBJECT GO_GRID2
  EXPORTING I_PARENT = GO_ALV_CON2.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_ALV_OBJ2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_ALV_OBJ2 .

<font color ="#0000FF">*-----------------------------------------------*</font>
  PERFORM SET_FIELDCAT2 CHANGING GT_FCAT2.
  PERFORM SET_LAYOUT2   CHANGING GS_LAYO2.
  PERFORM SET_SORT2     CHANGING GT_SORT2.
  PERFORM SET_GRID_EVENT_RECEIVER2.
  PERFORM SET_GRID_FIRST_DISPLAY2.
<font color ="#0000FF">*-----------------------------------------------*</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FIELDCAT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_FCAT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FIELDCAT2  CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA : LT_SLIS_FCAT  TYPE  SLIS_T_FIELDCAT_ALV.

  DATA : LV_PROG_NAME  LIKE SY-REPID.
  DATA : LV_INCLNAME   LIKE SY-REPID.

  DATA : LT_FCAT       TYPE  LVC_T_FCAT.

  CLEAR: LV_PROG_NAME, LV_INCLNAME.
  LV_PROG_NAME = SY-REPID.
  LV_INCLNAME  = SY-REPID.

  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'
    EXPORTING
      I_PROGRAM_NAME         = LV_PROG_NAME
      I_INCLNAME             = LV_INCLNAME
      I_CLIENT_NEVER_DISPLAY = 'X'
      I_INTERNAL_TABNAME     = 'GT_DISP2'
    CHANGING
      CT_FIELDCAT            = LT_SLIS_FCAT
   EXCEPTIONS
     INCONSISTENT_INTERFACE  = 1
     PROGRAM_ERROR           = 2
     OTHERS                  = 3.

  CALL FUNCTION 'LVC_TRANSFER_FROM_SLIS'
    EXPORTING
      IT_FIELDCAT_ALV = LT_SLIS_FCAT
    IMPORTING
      ET_FIELDCAT_LVC = LT_FCAT
    TABLES
      IT_DATA         = GT_DISP2
    EXCEPTIONS
      IT_DATA_MISSING = 1
      OTHERS          = 2.

  CALL FUNCTION 'LVC_FIELDCAT_COMPLETE'
    CHANGING
      CT_FIELDCAT = LT_FCAT.

  CLEAR: PT_FCAT[].
  PT_FCAT[] = LT_FCAT[].

  LOOP AT PT_FCAT ASSIGNING FIELD-SYMBOL(&lt;LFS_FCAT&gt;).
    &lt;LFS_FCAT&gt;-OUTPUTLEN = 12.
    &lt;LFS_FCAT&gt;-KEY       = SPACE.
    CASE &lt;LFS_FCAT&gt;-FIELDNAME.
      WHEN 'ICON'.
        &lt;LFS_FCAT&gt;-COLTEXT = '오더생성 상태'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
      WHEN 'BANFN'.
        &lt;LFS_FCAT&gt;-COLTEXT = '구매요청번호'.
        &lt;LFS_FCAT&gt;-KEY     = ' '.
        &lt;LFS_FCAT&gt;-EMPHASIZE = 'C310'.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'BNFPO'.
        &lt;LFS_FCAT&gt;-COLTEXT = '품목번호'.
        &lt;LFS_FCAT&gt;-KEY     = ' '.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.
      WHEN 'INFO_NO'.
        &lt;LFS_FCAT&gt;-COLTEXT = '정보레코드'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
      WHEN 'WERKS'.
        &lt;LFS_FCAT&gt;-COLTEXT = '플랜트'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
      WHEN 'MRPID'.
        &lt;LFS_FCAT&gt;-COLTEXT = 'MRP 결과'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
      WHEN 'MATNR'.
        &lt;LFS_FCAT&gt;-COLTEXT = '자재코드'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
      WHEN 'MENGE'.
        &lt;LFS_FCAT&gt;-COLTEXT = '요청 수량'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 15.
      WHEN 'MEINS'.
        &lt;LFS_FCAT&gt;-COLTEXT = '요청 단위'.
        &lt;LFS_FCAT&gt;-JUST = 'C'.
      WHEN 'SCODE'.
        &lt;LFS_FCAT&gt;-COLTEXT = '저장위치'.
        &lt;LFS_FCAT&gt;-JUST    = 'C'.
      WHEN OTHERS.
        &lt;LFS_FCAT&gt;-TECH    = 'X'.
    ENDCASE.
  ENDLOOP.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GS_LAYO2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT2  CHANGING PS_LAYO TYPE LVC_S_LAYO.

  CLEAR: PS_LAYO.
  PS_LAYO-NO_ROWINS  = 'X'.
  PS_LAYO-NO_ROWMOVE = 'X'.
  PS_LAYO-SEL_MODE   = 'D'.
  PS_LAYO-CWIDTH_OPT = 'A'.

  DATA : LV_TITLE TYPE LVC_TITLE.
  DATA(LV_CNT) = LINES( GT_DISP2 ).
  LV_TITLE = '구매요청:' && LV_CNT && '건'.
  PS_LAYO-GRID_TITLE = LV_TITLE.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_FIRST_DISPLAY2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_FIRST_DISPLAY2 .

  CALL METHOD GO_GRID2-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT                     = GS_LAYO2
    CHANGING
      IT_OUTTAB                     = GT_DISP2[]
      IT_FIELDCATALOG               = GT_FCAT2[]
      IT_SORT                       = GT_SORT2[]
    EXCEPTIONS
      INVALID_PARAMETER_COMBINATION = 1
      PROGRAM_ERROR                 = 2
      TOO_MANY_LINES                = 3
      OTHERS                        = 4.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FIELDCAT3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_FCAT3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FIELDCAT3  CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA : LT_SLIS_FCAT  TYPE  SLIS_T_FIELDCAT_ALV.

  DATA : LV_PROG_NAME  LIKE SY-REPID.
  DATA : LV_INCLNAME   LIKE SY-REPID.

  DATA : LT_FCAT       TYPE  LVC_T_FCAT.

  CLEAR: LV_PROG_NAME, LV_INCLNAME.
  LV_PROG_NAME = SY-REPID.
  LV_INCLNAME  = SY-REPID.

  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'
    EXPORTING
      I_PROGRAM_NAME         = LV_PROG_NAME
      I_INCLNAME             = LV_INCLNAME
      I_CLIENT_NEVER_DISPLAY = 'X'
      I_INTERNAL_TABNAME     = 'GT_DISP3'
    CHANGING
      CT_FIELDCAT            = LT_SLIS_FCAT
   EXCEPTIONS
     INCONSISTENT_INTERFACE  = 1
     PROGRAM_ERROR           = 2
     OTHERS                  = 3.

  CALL FUNCTION 'LVC_TRANSFER_FROM_SLIS'
    EXPORTING
      IT_FIELDCAT_ALV = LT_SLIS_FCAT
    IMPORTING
      ET_FIELDCAT_LVC = LT_FCAT
    TABLES
      IT_DATA         = GT_DISP3
    EXCEPTIONS
      IT_DATA_MISSING = 1
      OTHERS          = 2.

  CALL FUNCTION 'LVC_FIELDCAT_COMPLETE'
    CHANGING
      CT_FIELDCAT = LT_FCAT.

  CLEAR: PT_FCAT[].
  PT_FCAT[] = LT_FCAT[].

  LOOP AT PT_FCAT ASSIGNING FIELD-SYMBOL(&lt;LFS_FCAT&gt;).
    &lt;LFS_FCAT&gt;-KEY       = SPACE.
    CASE &lt;LFS_FCAT&gt;-FIELDNAME.
      WHEN 'LIGHT'.
        &lt;LFS_FCAT&gt;-COL_POS   = 1.
        &lt;LFS_FCAT&gt;-COLTEXT   = '상태'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'LV_PERCENT'.
        &lt;LFS_FCAT&gt;-COL_POS   = 2.
        &lt;LFS_FCAT&gt;-COLTEXT   = '현 재고 비율'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'MATNR'.
        &lt;LFS_FCAT&gt;-COL_POS = 2.
        &lt;LFS_FCAT&gt;-COLTEXT = '자재코드'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 9.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'MAKTX'.
        &lt;LFS_FCAT&gt;-COL_POS = 3.
        &lt;LFS_FCAT&gt;-COLTEXT = '자재명'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
      WHEN 'WERKS'.
        &lt;LFS_FCAT&gt;-COL_POS = 4.
        &lt;LFS_FCAT&gt;-COLTEXT = '플랜트'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'SCODE'.
        &lt;LFS_FCAT&gt;-COL_POS = 5.
        &lt;LFS_FCAT&gt;-COLTEXT = '저장위치'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
      WHEN 'CALQTY'.
        &lt;LFS_FCAT&gt;-COL_POS = 6.
        &lt;LFS_FCAT&gt;-COLTEXT = '재고수량(EA)'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
      WHEN 'MEINS'.
        &lt;LFS_FCAT&gt;-COL_POS = 7.
        &lt;LFS_FCAT&gt;-COLTEXT = '단위'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 4.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
<font color ="#0000FF">***      WHEN 'WEIGHT'.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-COL_POS = 8.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-COLTEXT = '재고수량(KG)'.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.</font>
<font color ="#0000FF">***      WHEN 'MEINS2'.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-COL_POS = 9.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-COLTEXT = '단위'.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-OUTPUTLEN = 4.</font>
<font color ="#0000FF">***        &lt;LFS_FCAT&gt;-JUST      = 'C'.</font>
      WHEN 'SAFSTK'.
        &lt;LFS_FCAT&gt;-COL_POS = 10.
        &lt;LFS_FCAT&gt;-COLTEXT = '안전재고'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
        &lt;LFS_FCAT&gt;-EMPHASIZE = 'C510'.
      WHEN 'MEINS3'.
        &lt;LFS_FCAT&gt;-COL_POS = 11.
        &lt;LFS_FCAT&gt;-COLTEXT = '단위'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 4.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
        &lt;LFS_FCAT&gt;-EMPHASIZE = 'C510'.
      WHEN OTHERS.
        &lt;LFS_FCAT&gt;-TECH = 'X'.
    ENDCASE.
  ENDLOOP.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GS_LAYO3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT3  CHANGING PS_LAYO TYPE LVC_S_LAYO.

  CLEAR: PS_LAYO.
  PS_LAYO-NO_ROWINS  = 'X'.
  PS_LAYO-NO_ROWMOVE = 'X'.
  PS_LAYO-SEL_MODE   = 'D'.
<font color ="#0000FF">*  PS_LAYO-CWIDTH_OPT = 'A'.</font>
  PS_LAYO-ZEBRA      = 'X'.
  PS_LAYO-EXCP_FNAME = 'LIGHT'.
<font color ="#0000FF">*</font>
  DATA : LV_TITLE TYPE LVC_TITLE.
  DATA(LV_CNT) = LINES( GT_DISP3 ).
  LV_TITLE = '원재료 재고 현황:'  && LV_CNT && '건'.
  PS_LAYO-GRID_TITLE = LV_TITLE.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_FIRST_DISPLAY3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_FIRST_DISPLAY3 .

  CALL METHOD GO_GRID3-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT                     = GS_LAYO3
    CHANGING
      IT_OUTTAB                     = GT_DISP3[]
      IT_FIELDCATALOG               = GT_FCAT3[]
      IT_SORT                       = GT_SORT3[]
    EXCEPTIONS
      INVALID_PARAMETER_COMBINATION = 1
      PROGRAM_ERROR                 = 2
      TOO_MANY_LINES                = 3
      OTHERS                        = 4.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT3 .

  CALL METHOD GO_SPLITTER-&gt;GET_CONTAINER
  EXPORTING ROW    = 2
            COLUMN = 1
  RECEIVING CONTAINER = GO_ALV_CON3.

<font color ="#0000FF">*  CALL METHOD GO_SPLITTER-&gt;SET_COLUMN_WIDTH</font>
<font color ="#0000FF">*  EXPORTING ID    = 2</font>
<font color ="#0000FF">*            WIDTH = 57.</font>

  CREATE OBJECT GO_GRID3
  EXPORTING I_PARENT = GO_ALV_CON3.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_ALV_OBJ3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_ALV_OBJ3 .

<font color ="#0000FF">*-----------------------------------------------*</font>
  PERFORM SET_FIELDCAT3 CHANGING GT_FCAT3.
  PERFORM SET_LAYOUT3   CHANGING GS_LAYO3.
  PERFORM SET_SORT3     CHANGING GT_SORT3.
  PERFORM SET_GRID_EVENT_RECEIVER3.
  PERFORM SET_GRID_FIRST_DISPLAY3.
<font color ="#0000FF">*-----------------------------------------------*</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_SORT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_SORT1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_SORT  CHANGING PT_SORT TYPE LVC_T_SORT.

  DATA : LS_SORT TYPE LVC_S_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 1.
  LS_SORT-FIELDNAME = 'PONUM'.
  LS_SORT-UP        = 'X'.
  LS_SORT-SUBTOT    = 'X'.
  APPEND LS_SORT TO PT_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 2.
  LS_SORT-FIELDNAME = 'EBELP'.
  LS_SORT-UP        = 'X'.
  APPEND LS_SORT TO PT_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 3.
  LS_SORT-FIELDNAME = 'BANFN'.
  LS_SORT-UP        = 'X'.
  APPEND LS_SORT TO PT_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 4.
  LS_SORT-FIELDNAME = 'CALQTY'.
<font color ="#0000FF">*  LS_SORT-SUBTOT    = 'X'.</font>
  APPEND LS_SORT TO PT_SORT.

  SORT PT_SORT BY FIELDNAME.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_SORT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_SORT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_SORT2  CHANGING PT_SORT TYPE LVC_T_SORT.

  DATA : LS_SORT TYPE LVC_S_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 1.
  LS_SORT-FIELDNAME = 'BANFN'.
  LS_SORT-UP        = 'X'.
  APPEND LS_SORT TO PT_SORT.

  SORT PT_SORT BY FIELDNAME.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0110 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE STATUS_0110 OUTPUT.

  SET PF-STATUS 'S0110'.
  SET TITLEBAR  'T0110'.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Module  USER_COMMAND_0110  INPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*       text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
MODULE USER_COMMAND_0110 INPUT.

  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
  ENDCASE.
  CLEAR: OK_CODE.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Module  EXIT_0110  INPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*       text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
MODULE EXIT_0110 INPUT.

  CASE OK_CODE.
    WHEN 'EXIT' OR 'CANC'.
      LEAVE TO SCREEN 0.
  ENDCASE.
  CLEAR: OK_CODE.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_EVENT_RECEIVER1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_EVENT_RECEIVER1.

  CREATE OBJECT LCL_EVENT_RECEIVER.

  SET HANDLER:
  LCL_EVENT_RECEIVER-&gt;HANDLE_HOTSPOT_CLICK1 FOR GO_GRID1,
  LCL_EVENT_RECEIVER-&gt;HANDLE_TOOLBAR1       FOR GO_GRID1,
  LCL_EVENT_RECEIVER-&gt;HANDLE_USER_COMMAND1  FOR GO_GRID1.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module INIT_0110 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE INIT_0110 OUTPUT.

  IF GO_CONTAINER4 IS INITIAL.

    CREATE OBJECT GO_CONTAINER4
    EXPORTING CONTAINER_NAME = 'CON4'.
    CREATE OBJECT GO_GRID4
    EXPORTING I_PARENT = GO_CONTAINER4.

    PERFORM SET_FIELDCAT4 CHANGING GT_FCAT4.
    PERFORM SET_LAYOUT4   CHANGING GS_LAYO4.
    PERFORM SET_SORT4     CHANGING GT_SORT4.
    PERFORM SET_GRID_EVENT_RECEIVER4.
    PERFORM SET_GRID_FIRST_DISPLAY4.
    PERFORM SET_GRID_SUBTOTAL4.

  ELSE.

    PERFORM REFRESH_TABLE_DISPLAY4.

  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FIELDCAT4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GT_FCAT4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FIELDCAT4  CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA : LT_SLIS_FCAT  TYPE  SLIS_T_FIELDCAT_ALV.

  DATA : LV_PROG_NAME  LIKE SY-REPID.
  DATA : LV_INCLNAME   LIKE SY-REPID.

  DATA : LT_FCAT       TYPE  LVC_T_FCAT.

  CLEAR: LV_PROG_NAME, LV_INCLNAME.
  LV_PROG_NAME = SY-REPID.
  LV_INCLNAME  = SY-REPID.

  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'
    EXPORTING
      I_PROGRAM_NAME         = LV_PROG_NAME
      I_INCLNAME             = LV_INCLNAME
      I_CLIENT_NEVER_DISPLAY = 'X'
      I_INTERNAL_TABNAME     = 'GT_DISP4'
    CHANGING
      CT_FIELDCAT            = LT_SLIS_FCAT
   EXCEPTIONS
     INCONSISTENT_INTERFACE  = 1
     PROGRAM_ERROR           = 2
     OTHERS                  = 3.

  CALL FUNCTION 'LVC_TRANSFER_FROM_SLIS'
    EXPORTING
      IT_FIELDCAT_ALV = LT_SLIS_FCAT
    IMPORTING
      ET_FIELDCAT_LVC = LT_FCAT
    TABLES
      IT_DATA         = GT_DISP4
    EXCEPTIONS
      IT_DATA_MISSING = 1
      OTHERS          = 2.

  CALL FUNCTION 'LVC_FIELDCAT_COMPLETE'
    CHANGING
      CT_FIELDCAT = LT_FCAT.

  CLEAR: PT_FCAT[].
  PT_FCAT[] = LT_FCAT[].

  LOOP AT PT_FCAT ASSIGNING FIELD-SYMBOL(&lt;LFS_FCAT&gt;).
    &lt;LFS_FCAT&gt;-KEY     = ' '.
    CASE &lt;LFS_FCAT&gt;-FIELDNAME.
WHEN 'TEXT'.
        &lt;LFS_FCAT&gt;-COL_POS   = 1.
        &lt;LFS_FCAT&gt;-COLTEXT   = '내역'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'L'.
WHEN 'ZLSCHYN'.
        &lt;LFS_FCAT&gt;-COL_POS   = 2.
        &lt;LFS_FCAT&gt;-COLTEXT   = '지급여부'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'GJAHR'.
        &lt;LFS_FCAT&gt;-COL_POS   = 3.
        &lt;LFS_FCAT&gt;-COLTEXT   = '회계연도'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'MBLNR'.
        &lt;LFS_FCAT&gt;-COL_POS = 4.
        &lt;LFS_FCAT&gt;-COLTEXT = '문서번호'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 12.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'MBGNO'.
        &lt;LFS_FCAT&gt;-COL_POS = 5.
        &lt;LFS_FCAT&gt;-COLTEXT = '품목번호'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 6.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'BWART'.
        &lt;LFS_FCAT&gt;-COL_POS = 6.
        &lt;LFS_FCAT&gt;-COLTEXT = '이동유형'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 7.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'GRUND'.
        &lt;LFS_FCAT&gt;-COL_POS = 7.
        &lt;LFS_FCAT&gt;-COLTEXT = '이동사유'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
WHEN 'MATNR'.
        &lt;LFS_FCAT&gt;-COL_POS = 8.
        &lt;LFS_FCAT&gt;-COLTEXT = '자재코드'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'PONUM'.
        &lt;LFS_FCAT&gt;-COL_POS = 9.
        &lt;LFS_FCAT&gt;-COLTEXT = '구매오더'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 10.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
<font color ="#0000FF">**WHEN 'PLANTFR'.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-COL_POS = 10.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-COLTEXT = 'From플랜트'.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.</font>
<font color ="#0000FF">**WHEN 'LGORTFR'.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-COL_POS = 11.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-COLTEXT = 'From저장위치'.</font>
<font color ="#0000FF">**        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.</font>
WHEN 'PLANTTO'.
        &lt;LFS_FCAT&gt;-COL_POS = 12.
        &lt;LFS_FCAT&gt;-COLTEXT = '플랜트'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'LGORTTO'.
        &lt;LFS_FCAT&gt;-COL_POS = 13.
        &lt;LFS_FCAT&gt;-COLTEXT = '저장위치'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 8.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'MENGE'.
        &lt;LFS_FCAT&gt;-COL_POS = 14.
        &lt;LFS_FCAT&gt;-COLTEXT = '수량'.
          &lt;LFS_FCAT&gt;-DO_SUM  = 'X'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 15.
WHEN 'MEINS'.
        &lt;LFS_FCAT&gt;-COL_POS = 15.
        &lt;LFS_FCAT&gt;-COLTEXT = '단위'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN 'DMBTR'.
        &lt;LFS_FCAT&gt;-COL_POS = 16.
        &lt;LFS_FCAT&gt;-COLTEXT = '금액'.
          &lt;LFS_FCAT&gt;-DO_SUM  = 'X'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 15.
WHEN 'WAERS1'.
        &lt;LFS_FCAT&gt;-COL_POS = 17.
        &lt;LFS_FCAT&gt;-COLTEXT = '통화'.
        &lt;LFS_FCAT&gt;-OUTPUTLEN = 5.
        &lt;LFS_FCAT&gt;-JUST      = 'C'.
WHEN OTHERS.
        &lt;LFS_FCAT&gt;-TECH = 'X'.
    ENDCASE.
  ENDLOOP.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GS_LAYO4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT4  CHANGING PS_LAYO TYPE LVC_S_LAYO.

  CLEAR: PS_LAYO.
  PS_LAYO-NO_ROWINS  = 'X'.
  PS_LAYO-NO_ROWMOVE = 'X'.
  PS_LAYO-SEL_MODE   = 'D'.
<font color ="#0000FF">*  PS_LAYO-NO_TOOLBAR = 'X'.</font>
<font color ="#0000FF">*  PS_LAYO-CWIDTH_OPT = 'A'.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_FIRST_DISPLAY4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_FIRST_DISPLAY4 .

  GO_GRID4-&gt;SET_TABLE_FOR_FIRST_DISPLAY(
    EXPORTING
      IS_LAYOUT                     = GS_LAYO4
    CHANGING
      IT_OUTTAB                     = GT_DISP4[]
      IT_FIELDCATALOG               = GT_FCAT4[]
      IT_SORT                       = GT_SORT4[]
    EXCEPTIONS
      INVALID_PARAMETER_COMBINATION = 1
      PROGRAM_ERROR                 = 2
      TOO_MANY_LINES                = 3
      OTHERS                        = 4         ).

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_EVENT_RECEIVER2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_EVENT_RECEIVER2 .

  CREATE OBJECT LCL_EVENT_RECEIVER.

  SET HANDLER:
  LCL_EVENT_RECEIVER-&gt;HANDLE_TOOLBAR2      FOR GO_GRID2,
  LCL_EVENT_RECEIVER-&gt;HANDLE_USER_COMMAND2 FOR GO_GRID2.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form REFRESH_TABLE_DISPLAY4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM REFRESH_TABLE_DISPLAY4 .

  DATA : LS_STBL TYPE LVC_S_STBL.

  CLEAR: LS_STBL.
  LS_STBL-ROW = 'X'.
  LS_STBL-COL = 'X'.

  CHECK GO_GRID4 IS NOT INITIAL.

  CLEAR: GT_FCAT4[].
  PERFORM SET_FIELDCAT4 CHANGING GT_FCAT4.
  CALL METHOD GO_GRID4-&gt;SET_FRONTEND_FIELDCATALOG
  EXPORTING IT_FIELDCATALOG = GT_FCAT4.

  CLEAR: GS_LAYO4.
  PERFORM SET_LAYOUT4   CHANGING GS_LAYO4.
  CALL METHOD GO_GRID4-&gt;SET_FRONTEND_LAYOUT
  EXPORTING IS_LAYOUT = GS_LAYO4.

  CALL METHOD GO_GRID4-&gt;REFRESH_TABLE_DISPLAY
  EXPORTING IS_STABLE = LS_STBL.

  PERFORM SET_GRID_SUBTOTAL4.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_SORT4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      &lt;-- GS_SORT4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_SORT4 CHANGING PT_SORT TYPE LVC_T_SORT.

  DATA : LS_SORT TYPE LVC_S_SORT.

  CLEAR: LS_SORT.
  LS_SORT-SPOS      = 1.
  LS_SORT-FIELDNAME = 'TEXT'.
  LS_SORT-DOWN      = 'X'.
  LS_SORT-SUBTOT    = 'X'.
  APPEND LS_SORT TO PT_SORT.

  SORT PT_SORT BY FIELDNAME.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_SUBTOTAL4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_SUBTOTAL4.

  FIELD-SYMBOLS:  &lt;LFS_TOTAL&gt;     LIKE LINE OF  GT_DISP4.
  FIELD-SYMBOLS:  &lt;LFS_SUBTOTAL&gt;  LIKE LINE OF  GT_DISP4.

  DATA : TOTAL    TYPE REF TO DATA.
  DATA : SUBTOTAL TYPE REF TO DATA.

  FIELD-SYMBOLS: &lt;TOTAL&gt;    LIKE GT_DISP4[].
  FIELD-SYMBOLS: &lt;SUBTOTAL&gt; LIKE GT_DISP4[].

  CALL METHOD GO_GRID4-&gt;GET_SUBTOTALS
    IMPORTING
      EP_COLLECT00 = TOTAL
      EP_COLLECT01 = SUBTOTAL.

  ASSIGN TOTAL-&gt;*    TO &lt;TOTAL&gt;.
  ASSIGN SUBTOTAL-&gt;* TO &lt;SUBTOTAL&gt;.

  LOOP AT &lt;TOTAL&gt; ASSIGNING &lt;LFS_TOTAL&gt;.
    &lt;LFS_TOTAL&gt;-MBLNR = '총계'.
  ENDLOOP.

  LOOP AT &lt;SUBTOTAL&gt; ASSIGNING &lt;LFS_SUBTOTAL&gt;.
    IF &lt;LFS_SUBTOTAL&gt;-TEXT CP 'WE'.
      &lt;LFS_SUBTOTAL&gt;-MBLNR = 'Tr./ev. 입고'.
    ELSE.
      &lt;LFS_SUBTOTAL&gt;-MBLNR = 'Tr./ev. 송장'.
    ENDIF.
  ENDLOOP.

  CALL METHOD GO_GRID4-&gt;REFRESH_TABLE_DISPLAY
  EXPORTING I_SOFT_REFRESH = 'X'.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_GRID_EVENT_RECEIVER4</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_GRID_EVENT_RECEIVER4 .

  CREATE OBJECT LCL_EVENT_RECEIVER.

  SET HANDLER:
  LCL_EVENT_RECEIVER-&gt;HANDLE_TOOLBAR4      FOR GO_GRID4.

ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 754
</font>
</body>
</html>
